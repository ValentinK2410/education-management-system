#!/bin/bash

echo "üöÄ –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä..."

# –ò—Å–ø–æ–ª—å–∑—É–µ–º expect –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è
expect << 'EXPECT_SCRIPT'
spawn ssh -o StrictHostKeyChecking=no root@82.146.39.18
expect "password:"
send "lShzBqBqnsHcR2sUos8v4XT4\r"
expect "#"
send "cd /var/www/www-root/data/www/m.dekan.pro\r"
expect "#"
send "echo 'üì• –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥ —Å GitHub...'\r"
expect "#"
send "git fetch origin\r"
expect "#"
send "git reset --hard origin/main\r"
expect "#"
send "echo 'üì¶ –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...'\r"
expect "#"
send "composer install --no-dev --optimize-autoloader\r"
expect "#"
send "echo 'üßπ –û—á–∏—â–∞–µ–º –∫—ç—à...'\r"
expect "#"
send "php artisan config:clear\r"
expect "#"
send "php artisan cache:clear\r"
expect "#"
send "php artisan view:clear\r"
expect "#"
send "echo 'üóÑÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏...'\r"
expect "#"
send "php artisan migrate --force\r"
expect "#"
send "echo '‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ...'\r"
expect "#"
send "php artisan config:cache\r"
expect "#"
send "php artisan route:cache\r"
expect "#"
send "php artisan view:cache\r"
expect "#"
send "echo 'üîê –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞...'\r"
expect "#"
send "chown -R www-data:www-data storage bootstrap/cache\r"
expect "#"
send "chmod -R 775 storage bootstrap/cache\r"
expect "#"
send "echo '‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!'\r"
expect "#"
send "exit\r"
expect eof
EXPECT_SCRIPT

echo "üåê –ü—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: http://82.146.39.18"
