# Добавление прав работы с пользователями

## Описание

Добавлены права для работы с пользователями и управления видимостью элементов интерфейса:

**Права работы с пользователями:**

-   **view_users** - Просматривать пользователей
-   **edit_users** - Редактировать пользователей
-   **delete_users** - Удалять пользователей
-   **hide_user_links** - Скрывать ссылки на пользователей

**Права управления видимостью боковой панели:**

-   **view_sidebar_users** - Видеть раздел "Пользователи" в боковой панели
-   **view_sidebar_institutions** - Видеть раздел "Учебные заведения" в боковой панели
-   **view_sidebar_programs** - Видеть раздел "Программы" в боковой панели
-   **view_sidebar_courses** - Видеть раздел "Курсы" в боковой панели
-   **view_sidebar_roles** - Видеть раздел "Роли" в боковой панели
-   **view_sidebar_reviews** - Видеть раздел "Отзывы" в боковой панели
-   **view_sidebar_certificates** - Видеть раздел "Шаблоны сертификатов" в боковой панели
-   **view_sidebar_archive** - Видеть раздел "Архив пользователей" в боковой панели

## Использование

### Автоматическое добавление через сидер

Для добавления новых прав в существующую базу данных выполните:

```bash
php artisan db:seed --class=AddUserPermissionsSeeder
```

Или если нужно пересоздать все данные:

```bash
php artisan migrate:fresh --seed
```

### Ручное добавление через админ панель

1. Перейдите в раздел "Роли" в админ панели
2. Выберите роль, которой нужно назначить права
3. Отметьте нужные права:
    - Просматривать пользователей
    - Редактировать пользователей
    - Удалять пользователей
4. Сохраните изменения

## Проверка прав в коде

Для проверки прав в контроллерах используйте:

```php
// Проверка права на просмотр пользователей
if (auth()->user()->hasPermission('view_users')) {
    // Разрешено просматривать пользователей
}

// Проверка права на редактирование пользователей
if (auth()->user()->hasPermission('edit_users')) {
    // Разрешено редактировать пользователей
}

// Проверка права на удаление пользователей
if (auth()->user()->hasPermission('delete_users')) {
    // Разрешено удалять пользователей
}

// Проверка права на скрытие ссылок на пользователей
if (auth()->user()->hasPermission('hide_user_links')) {
    // Скрыть ссылки на пользователей
}

// Проверка прав видимости боковой панели
if (auth()->user()->hasPermission('view_sidebar_users')) {
    // Показать ссылку "Пользователи" в боковой панели
}
```

## Использование в Blade шаблонах

В Blade шаблонах элементы боковой панели автоматически скрываются, если у пользователя нет соответствующего права:

```blade
@if(auth()->user()->hasPermission('view_sidebar_users') && !auth()->user()->hasPermission('hide_user_links'))
    <div class="nav-item">
        <a href="{{ route('admin.users.index') }}" class="nav-link">
            <i class="fas fa-users"></i>
            <span>Пользователи</span>
        </a>
    </div>
@endif
```

**Важно:** Если у пользователя есть право `hide_user_links`, ссылка на пользователей будет скрыта даже при наличии права `view_sidebar_users`.

## Назначение прав ролям

По умолчанию все новые права автоматически назначаются роли **Администратор**.

Для назначения прав другим ролям:

1. Используйте админ панель (раздел "Роли")
2. Или выполните в коде:

```php
use App\Models\Role;
use App\Models\Permission;

$role = Role::where('slug', 'instructor')->first();
$permissions = Permission::whereIn('slug', ['view_users', 'edit_users'])->pluck('id');
$role->permissions()->sync($permissions);
```
